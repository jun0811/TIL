[문제] - 문제 유형은 아래와 같이 이전과 동일.

N개 자석의 자성 정보와 자석을 1칸씩 K 번 회전시키려고 할 때,

K 번 자석을 회전시킨 후 획득하는 점수의 총 합을 출력하는 프로그램을 작성하라.



[제약사항]
1. 자석의 개수는 N 개이며, 각 자석은 M개의 날을 가지고 있다. (단, M은 2의 제곱수)

2. 자석을 회전시키는 횟수 K 는 1 이상 20 이하의 정수이다. ( 1 ≤ K ≤ 20 )

3. 하나의 자석이 1 칸 회전될 때, 붙어 있는 자석은 서로 붙어 있는 날의 자성이 다를 경우에만 반대 방향으로 1 칸 회전된다.

4. 자석을 회전시키는 방향은 시계방향이 1 로, 반시계 방향이 -1 로 주어진다.

5. 날의 자성은 N 극이 0 으로, S 극이 1 로 주어진다.

6. 각 자석의 날 자성정보는 빨간색 화살표 위치의 날부터 시계방향 순서대로 주어진다.

  예를 들어, N=4, M=8 [Fig. 1] 의 1 번 자석의 자성정보는 0 0 1 0 0 1 0 0 과 같이 주어진다.




[입력]

입력의 맨 첫 줄에는 총 테스트 케이스의 개수 T 가 주어지고,

그 다음 줄부터 T 개의 테스트 케이스가 주어진다.

그 다음 줄에는 자석수(N)와 칼날 수(M)가 주어진다.

각 테스트 케이스의 첫 번째 줄에는 자석을 회전시키는 횟수 K 가 주어진다.

다음 4 개의 줄에는 1 번 자석부터 4 번 자석까지 각각 8 개 날의 자성정보가 차례대로 주어진다.

그 다음 K 개의 줄에는 자석을 1칸씩 회전시키는 회전 정보가 주어진다.

자석의 회전 정보는 회전시키려는 자석의 번호, 회전방향으로 구성되어 있다.

회전방향은 1 일 경우 시계방향이며, -1 일 경우 반시계방향이다.